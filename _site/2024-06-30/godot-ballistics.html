<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ballistic arc when you have a set start and end point in Godot | Quellus</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="Ballistic arc when you have a set start and end point in Godot" />
<meta name="author" content="Quellus" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I added a new tower to my Godot tower defense game recently. Instead of firing bullets or lasers like my other towers, it launches missiles. These missiles required a creative solution because they have a ballistic arc and a set start and end point." />
<meta property="og:description" content="I added a new tower to my Godot tower defense game recently. Instead of firing bullets or lasers like my other towers, it launches missiles. These missiles required a creative solution because they have a ballistic arc and a set start and end point." />
<link rel="canonical" href="http://localhost:4000/2024-06-30/godot-ballistics" />
<meta property="og:url" content="http://localhost:4000/2024-06-30/godot-ballistics" />
<meta property="og:site_name" content="Quellus" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-30T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ballistic arc when you have a set start and end point in Godot" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Quellus"},"dateModified":"2024-06-30T00:00:00-06:00","datePublished":"2024-06-30T00:00:00-06:00","description":"I added a new tower to my Godot tower defense game recently. Instead of firing bullets or lasers like my other towers, it launches missiles. These missiles required a creative solution because they have a ballistic arc and a set start and end point.","headline":"Ballistic arc when you have a set start and end point in Godot","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2024-06-30/godot-ballistics"},"url":"http://localhost:4000/2024-06-30/godot-ballistics"}</script>
<!-- End Jekyll SEO tag -->


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png">

  <!-- RSS -->
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Quellus" />

  <!-- Google Analytics-->
  
</head>


  <body>

    <nav class="nav">
  <div class="nav-container">
    <a href="/">
      <h2 class="nav-title">Quellus</h2>
    </a>
    <ul>
      <li><a href="/">Posts</a></li>
      <li><a href="/tags">Tags</a></li>
      <li><a href="/about">About</a></li>
    </ul>
  </div>
</nav>


    <main>
      <div class="post">
  <div class="post-info">
    <span>Written by</span>
    
        Quellus
    

    
      <br>
      <span>on&nbsp;</span><time datetime="2024-06-30 00:00:00 -0600">June 30, 2024</time>
    
  </div>

  <h1 class="post-title">Ballistic arc when you have a set start and end point in Godot</h1>
  <div class="post-line"></div>

  <p>I added a new tower to my Godot tower defense game recently. Instead of firing bullets or lasers like my other towers, it launches missiles. These missiles required a creative solution because they have a ballistic arc and a set start and end point.</p>

<h2 id="what-didnt-work">What didn’t work</h2>

<h3 id="physics">Physics</h3>

<p>My first step when I was implementing this tower was to Google. Most results I’ve found suggest leaving it up to the physics engine. Make the bullet a rigid body, then give it gravity and an initial velocity. The physics engine will generate simulate a ballistic arc for you.</p>

<p>This doesn’t work because we have a set start and end point. With the physics approach, the end point of the arc is unpredictable. I could try adjusting the gravity and velocity to get it pretty close to the right end point, but it would be messy.</p>

<h3 id="bezier-interpolation">Bezier interpolation</h3>

<p>THe next idea I had, which I actually implemented, was using Vector3’s <a href="https://docs.godotengine.org/en/stable/classes/class_vector3.html#class-vector3-method-bezier-interpolate"><code class="language-plaintext highlighter-rouge">bezier_interpolate</code></a> function. In short, it generates a bezier curve from the points you supply it, you increment a time variable, and the function returns the position on the curve at that point in time. A bezier curves works with 4 points. P1 and P2 below denote the start and end of the curve. C1 and C2 are control points dictating the amount curvature.</p>

<p><img src="/_images/BezierCurve.png" alt="Bezier Curve" /></p>

<p>The reason this approach doesn’t work for me is that the speed of the missile isn’t constant. A longer curve results in a very fast moving missile, and the a shorter curve results in a very slow moving missile. I tried adjusting the passage of time based on the distance of the curve, but it was kind of messy and very imperfect.</p>

<p>Here’s a snippet of code that may help if you decide to try this approach for yourself.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>var time_left_ratio = (time_left / total_time)
var p1 = start_pos
p1.y += peak_height
var p2 = target_pos
p2.y += peak_height
var next_position = start_pos.bezier_interpolate(p1, p2, target_pos, 1 - time_left_ratio)
look_at(next_position + Vector3(0.001, 0, 0), Vector3.UP)
position = next_position
</code></pre></div></div>

<h2 id="what-did-work">What did work</h2>

<p>My <strong>hopefully</strong> final attempt involved <a href="https://docs.godotengine.org/en/stable/classes/class_path3d.html">Path3D</a>. Everytime the the missile launcher wants to launch a missile, it first generates a Path3D, then spawns the missile as a <a href="https://docs.godotengine.org/en/stable/classes/class_pathfollow3d.html">PathFollow3D</a> to follow the path. I imagine it’s not very efficient to be spawning and deleting nodes so often, but it’s the best solution I’ve found so far.</p>

<p>Here’s how it works:</p>

<p>Path3D works on the same principle as the previous explanation. It’s a bezier curve, but instead of 4 points, it’s generated from 2. The first control point is passed in as the “out” variable of the first point, and the second control point the “in” variable of the second point.</p>

<p>This method also comes with the benefit that the pathfollower automatically rotates itself. I had to rotate the missile manually in the previous solution.</p>

</div>



<div class="pagination">
  
  

  <a href="#" class="top">Top</a>
</div>
    </main>

    <footer>
  <span>
    &copy; <time datetime="2024-06-30 09:52:03 -0600">2024</time> Quellus. Made with Jekyll using the <a href="https://github.com/chesterhow/tale/">Tale</a> theme.
  </span>
</footer>

  </body>
</html>
